# Syrian webmailer Installation Campaign

An all Web Shell by oRb (WSO) PHP file installation campaign.

First, they tried to install [m1.php](m1.php) a grotesquely obscured web mailer.
After an invocation of `m1.php` that my WOS honey pot wasn't smart enough to emulate,
the fooled around in my WSO honey pot, installed the Blacktools PHP Mailer,
tried to invoke it, and apparently became confused.


## Timeline

| Timestamp     | Action |Inter-request interval|
|---------------|--------|---------|
|[2018-10-18T05:53:38.729-0600](files/5.155.21.37W8kdAuEeepC4YlIMputp@QAAAAI.wso.scans)|Initial GET WSO URL||
|[2018-10-18T05:53:45.871-0600](files/5.155.21.37W8kdCQjgYQboDw0oE3QkdwAAAAw.wso.scans)|WSO login, "nhzgrf"|7.143|
|[2018-10-18T05:54:26.428-0600](files/5.155.21.37W8kdMqkBdgf2W0d7AEB4fQAAAAA.wso.scans)|FilesMAn/uploadFile of "m1.php"|40.557|
|[2018-10-18T05:54:33.437-0600](files/5.155.21.37W8kdOZLREdIUSeOQW9ZmxwAAAAY.wso.scans)|m1.php access|7.008|
|[2018-10-18T05:54:36.957-0600](files/5.155.21.37W8kdPKhhDJIu4xGPOS7ZVAAAAAo.wso.scans)|WSO listing of /var/www/html/wordpress/wp-content/plugins|3.52|
|[2018-10-18T05:54:47.921-0600](files/5.155.21.37W8kdR@EeepC4YlIMputp@wAAAAI.wso.scans)|FilesMAn/uploadFile of "m1.php"|10.965|
|[2018-10-18T05:54:59.707-0600](files/5.155.21.37W8kdU60Ic1oJpbQKjdYrgQAAAAU.wso.scans)|FilesTools view of /var/www/html/xmlrpc.php|11.785|
|[2018-10-18T05:55:06.052-0600](files/5.155.21.37W8kdWtdvBAcAN4NjwFs6nwAAAAg.wso.scans)|FilesTools view of z1.php|6.346|
|[2018-10-18T05:55:16.976-0600](files/5.155.21.37W8kdZJLREdIUSeOQW9ZmyAAAAAY.wso.scans)|Request for FilesMan console|10.924|
|[2018-10-18T05:55:18.127-0600](files/5.155.21.37W8kdZpLREdIUSeOQW9ZmyQAAAAY.wso.scans)|Request for FilesMan console|1.15|
|[2018-10-18T05:55:19.431-0600](files/5.155.21.37W8kdZ5LREdIUSeOQW9ZmygAAAAY.wso.scans)|FilesMan display of "/"|1.305|
|[2018-10-18T05:55:22.395-0600](files/5.155.21.37W8kdapLREdIUSeOQW9ZmywAAAAY.wso.scans)|FilesMan of /var/www/html/|2.964|
|[2018-10-18T05:55:24.249-0600](files/5.155.21.37W8kdbJLREdIUSeOQW9ZmzAAAAAY.wso.scans)|FilesMan of /var/www/|1.853|
|[2018-10-18T05:55:26.809-0600](files/5.155.21.37W8kdbpLREdIUSeOQW9ZmzQAAAAY.wso.scans)|FilesMan of /var/www/html/|2.56|
|[2018-10-18T05:55:29.605-0600](files/5.155.21.37W8kdcZLREdIUSeOQW9ZmzgAAAAY.wso.scans)|FilesMan of /var/www/html/wp-admin/|2.797|
|[2018-10-18T05:55:31.167-0600](files/5.155.21.37W8kdc5LREdIUSeOQW9ZmzwAAAAY.wso.scans)|FilesMan of /var/www/html/wp-admin/|1.561|
|[2018-10-18T05:55:36.924-0600](files/5.155.21.37W8kdeAjgYQboDw0oE3QkeQAAAAw.wso.scans)|FilesMan of /var/www/html/wp-content/|5.757|
|[2018-10-18T05:55:38.950-0600](files/5.155.21.37W8kdegjgYQboDw0oE3QkegAAAAw.wso.scans)|FilesMan of /var/www/html/wp-content/|2.027|
|[2018-10-18T05:55:39.881-0600](files/5.155.21.37W8kdewYXbEItlgRDsZoWYwAAAAM.wso.scans)|FilesMan of /var/www/html/wp-content/|0.931|
|[2018-10-18T05:55:43.138-0600](files/5.155.21.37W8kdfwYXbEItlgRDsZoWZAAAAAM.wso.scans)|FilesMan of /var/www/html/wordpress//wp-content/plugins/wp-mobile-detector/cache|3.256|
|[2018-10-18T05:56:04.476-0600](files/5.155.21.37W8kdlKkBdgf2W0d7AEB4fwAAAAA.wso.scans)|FilesMan of /var/www/html/wordpress//wp-content/plugins/wp-mobile-detector/cache|21.339|
|[2018-10-18T05:56:21.648-0600](files/5.155.21.37W8kdpf255o25UuOJAMdc0wAAAAQ.wso.scans)|FilesMAn/uploadFile of blacktools.php|17.172|
|[2018-10-18T05:56:36.835-0600](files/5.155.21.37W8kdtAjgYQboDw0oE3QkewAAAAw.wso.scans)|FilesMan of /var/www/html/wordpress//wp-content/plugins/wp-mobile-detector/cache|15.186|
|[2018-10-18T05:56:44.492-0600](files/5.155.21.37W8kdvAYXbEItlgRDsZoWZQAAAAM.wso.scans)|GET of /wordpress//wp-content/plugins/wp-mobile-detector/cache/db.php|7.657|
|[2018-10-18T05:56:53.957-0600](files/5.155.21.37W8kdxddvBAcAN4NjwFs6oQAAAAg.wso.scans)|GET of /wordpress//wp-content/plugins/wp-mobile-detector/cache/blacktools.php|9.465|
|[2018-10-18T05:57:00.414-0600](files/5.155.21.37W8kdzHr5Vo0meSQQvZfzxQAAAAc.wso.scans)|GET of /wordpress//wp-content/plugins/wp-mobile-detector/blacktools.php|6.458|
|[2018-10-18T05:57:14.364-0600](files/5.155.21.37W8kd2qhhDJIu4xGPOS7ZVwAAAAo.wso.scans)|GET of /wordpress//wp-content/plugins/wp-mobile-detector/cache/db.php|13.949|
|[2018-10-18T05:57:27.171-0600](files/5.155.21.37W8kd59dvBAcAN4NjwFs6ogAAAAg.wso.scans)|GET of /wordpress//wp-content/plugins/wp-mobile-detector/blacktools.php|12.808|
|[2018-10-18T05:57:31.924-0600](files/5.155.21.37W8kd69dvBAcAN4NjwFs6owAAAAg.wso.scans)|GET of blacktools.php, with WSO password of "nhzgrf"|4.752|
|[2018-10-18T05:57:45.713-0600](files/5.155.21.37W8kd@QjgYQboDw0oE3QkfQAAAAw.wso.scans)|GET of /wordpress//wp-content/plugins/wp-mobile-detector/cache/db.php|13.79|
|[2018-10-18T05:57:48.951-0600](files/5.155.21.37W8kd-K0Ic1oJpbQKjdYrhQAAAAU.wso.scans)|FilesMan of /var/www/html/wordpress/wp-content|3.238|
|[2018-10-18T05:57:51.519-0600](files/5.155.21.37W8kd-60Ic1oJpbQKjdYrhgAAAAU.wso.scans)|FilesMan of /var/www/html/wp-admin|2.567|
|[2018-10-18T05:57:53.121-0600](files/5.155.21.37W8keAa0Ic1oJpbQKjdYrhwAAAAU.wso.scans)|FilesMan of /var/www/html/wp-content|1.603|
|[2018-10-18T05:57:57.094-0600](files/5.155.21.37W8keBa0Ic1oJpbQKjdYriAAAAAU.wso.scans)|FilesMan of /var/www/html/wordpress//wp-content/plugins/wp-mobile-detector/cache|3.972|

## Analysis

"nhzgrf" is a very commonly used WSO password.

Based on the intervals between HTTP requests, I'd have to say this was a human-driven campaign.
Beyond the inter-request intervals, only a human would repeatedly try to invoke the same URL,
upload a different, second mail tool, and walk up and down the directory tree.

My WSO honey pot does provide reasonably authentic file listings of a few directories
(`/var`, `/var/www`, `/var/www/html`), but it did not provide enough listings of well-known
WordPress directories.
The human driving this must have felt a lot of confusion.

## m1.php

The initial download was for a file [m1.php](m1.php),
which turns out to be a heavily obscured web-enabled email tool.
My goodness, it had about 9 layers of gzipping-base64-encoding-repeat.

`m1.php` doesn't seem related to Blacktool PHP Mailer,
but my honey pot has caught it or variants before.

The [Rebels Mailer](../176.234.34.233-2018-04-13a) seems like it might be
a distant cousion of `m1.php`.
They share a lot of the same plain-text error messages.
